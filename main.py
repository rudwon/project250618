import streamlit as st
import pandas as pd
import math

st.set_page_config(page_title="전 주기율표 인터랙티브", layout="wide")

# 118개 원소 완전 데이터 (한국어 이름 포함)
elements = [
    (1, "H", "수소", 1.008, "비금속", 1, 1),
    (2, "He", "헬륨", 4.002602, "비활성기체", 1, 18),
    (3, "Li", "리튬", 6.94, "알칼리금속", 2, 1),
    (4, "Be", "베릴륨", 9.0122, "알칼리토금속", 2, 2),
    (5, "B", "붕소", 10.81, "준금속", 2, 13),
    (6, "C", "탄소", 12.011, "비금속", 2, 14),
    (7, "N", "질소", 14.007, "비금속", 2, 15),
    (8, "O", "산소", 15.999, "비금속", 2, 16),
    (9, "F", "플루오린", 18.998403163, "할로젠", 2, 17),
    (10, "Ne", "네온", 20.1797, "비활성기체", 2, 18),
    (11, "Na", "나트륨", 22.98976928, "알칼리금속", 3, 1),
    (12, "Mg", "마그네슘", 24.305, "알칼리토금속", 3, 2),
    (13, "Al", "알루미늄", 26.9815385, "기타금속", 3, 13),
    (14, "Si", "규소", 28.085, "준금속", 3, 14),
    (15, "P", "인", 30.973761998, "비금속", 3, 15),
    (16, "S", "황", 32.06, "비금속", 3, 16),
    (17, "Cl", "염소", 35.45, "할로젠", 3, 17),
    (18, "Ar", "아르곤", 39.948, "비활성기체", 3, 18),
    (19, "K", "칼륨", 39.0983, "알칼리금속", 4, 1),
    (20, "Ca", "칼슘", 40.078, "알칼리토금속", 4, 2),
    (21, "Sc", "스칸듐", 44.955908, "전이금속", 4, 3),
    (22, "Ti", "티타늄", 47.867, "전이금속", 4, 4),
    (23, "V", "바나듐", 50.9415, "전이금속", 4, 5),
    (24, "Cr", "크로뮴", 51.9961, "전이금속", 4, 6),
    (25, "Mn", "망간", 54.938044, "전이금속", 4, 7),
    (26, "Fe", "철", 55.845, "전이금속", 4, 8),
    (27, "Co", "코발트", 58.933194, "전이금속", 4, 9),
    (28, "Ni", "니켈", 58.6934, "전이금속", 4, 10),
    (29, "Cu", "구리", 63.546, "전이금속", 4, 11),
    (30, "Zn", "아연", 65.38, "전이금속", 4, 12),
    (31, "Ga", "갈륨", 69.723, "기타금속", 4, 13),
    (32, "Ge", "저마늄", 72.63, "준금속", 4, 14),
    (33, "As", "비소", 74.921595, "준금속", 4, 15),
    (34, "Se", "셀레늄", 78.971, "비금속", 4, 16),
    (35, "Br", "브롬", 79.904, "할로젠", 4, 17),
    (36, "Kr", "크립톤", 83.798, "비활성기체", 4, 18),
    (37, "Rb", "루비듐", 85.4678, "알칼리금속", 5, 1),
    (38, "Sr", "스트론튬", 87.62, "알칼리토금속", 5, 2),
    (39, "Y", "이트륨", 88.90584, "전이금속", 5, 3),
    (40, "Zr", "지르코늄", 91.224, "전이금속", 5, 4),
    (41, "Nb", "니오브", 92.90637, "전이금속", 5, 5),
    (42, "Mo", "몰리브덴", 95.95, "전이금속", 5, 6),
    (43, "Tc", "테크네튬", 98, "전이금속", 5, 7),
    (44, "Ru", "루테늄", 101.07, "전이금속", 5, 8),
    (45, "Rh", "로듐", 102.90550, "전이금속", 5, 9),
    (46, "Pd", "팔라듐", 106.42, "전이금속", 5, 10),
    (47, "Ag", "은", 107.8682, "전이금속", 5, 11),
    (48, "Cd", "카드뮴", 112.414, "전이금속", 5, 12),
    (49, "In", "인듐", 114.818, "기타금속", 5, 13),
    (50, "Sn", "주석", 118.710, "기타금속", 5, 14),
    (51, "Sb", "안티몬", 121.760, "준금속", 5, 15),
    (52, "Te", "텔루륨", 127.60, "준금속", 5, 16),
    (53, "I", "아이오딘", 126.90447, "할로젠", 5, 17),
    (54, "Xe", "제논", 131.293, "비활성기체", 5, 18),
    (55, "Cs", "세슘", 132.90545196, "알칼리금속", 6, 1),
    (56, "Ba", "바륨", 137.327, "알칼리토금속", 6, 2),
    (57, "La", "란타넘", 138.90547, "란타노이드", 6, None),
    (58, "Ce", "세륨", 140.116, "란타노이드", 6, None),
    (59, "Pr", "프라세오디뮴", 140.90766, "란타노이드", 6, None),
    (60, "Nd", "네오디뮴", 144.242, "란타노이드", 6, None),
    (61, "Pm", "프로메튬", 145, "란타노이드", 6, None),
    (62, "Sm", "사마륨", 150.36, "란타노이드", 6, None),
    (63, "Eu", "유로퓸", 151.964, "란타노이드", 6, None),
    (64, "Gd", "가돌리늄", 157.25, "란타노이드", 6, None),
    (65, "Tb", "테르븀", 158.92535, "란타노이드", 6, None),
    (66, "Dy", "디스프로슘", 162.500, "란타노이드", 6, None),
    (67, "Ho", "홀뮴", 164.93033, "란타노이드", 6, None),
    (68, "Er", "어븀", 167.259, "란타노이드", 6, None),
    (69, "Tm", "툴륨", 168.93422, "란타노이드", 6, None),
    (70, "Yb", "이트륨", 173.04, "란타노이드", 6, None),
    (71, "Lu", "루테튬", 174.9668, "란타노이드", 6, None),
    (72, "Hf", "하프늄", 178.49, "전이금속", 6, 4),
    (73, "Ta", "탄탈럼", 180.94788, "전이금속", 6, 5),
    (74, "W", "텅스텐", 183.84, "전이금속", 6, 6),
    (75, "Re", "레늄", 186.207, "전이금속", 6, 7),
    (76, "Os", "오스뮴", 190.23, "전이금속", 6, 8),
    (77, "Ir", "이리듐", 192.217, "전이금속", 6, 9),
    (78, "Pt", "플래티넘", 195.084, "전이금속", 6, 10),
    (79, "Au", "금", 196.966569, "전이금속", 6, 11),
    (80, "Hg", "수은", 200.592, "전이금속", 6, 12),
    (81, "Tl", "탈륨", 204.38, "기타금속", 6, 13),
    (82, "Pb", "납", 207.2, "기타금속", 6, 14),
    (83, "Bi", "비스무트", 208.98040, "기타금속", 6, 15),
    (84, "Po", "폴로늄", 209, "준금속", 6, 16),
    (85, "At", "아스타틴", 210, "할로젠", 6, 17),
    (86, "Rn", "라돈", 222, "비활성기체", 6, 18),
    (87, "Fr", "프랑슘", 223, "알칼리금속", 7, 1),
    (88, "Ra", "라듐", 226, "알칼리토금속", 7, 2),
    (89, "Ac", "악티늄", 227, "악티노이드", 7, None),
    (90, "Th", "토륨", 232.0377, "악티노이드", 7, None),
    (91, "Pa", "프로트악티늄", 231.03588, "악티노이드", 7, None),
    (92, "U", "우라늄", 238.02891, "악티노이드", 7, None),
    (93, "Np", "넵투늄", 237, "악티노이드", 7, None),
    (94, "Pu", "플루토늄", 244, "악티노이드", 7, None),
    (95, "Am", "아메리슘", 243, "악티노이드", 7, None),
    (96, "Cm", "퀴륨", 247, "악티노이드", 7, None),
    (97, "Bk", "버클륨", 247, "악티노이드", 7, None),
    (98, "Cf", "캘리포늄", 251, "악티노이드", 7, None),
    (99, "Es", "아인스타이늄", 252, "악티노이드", 7, None),
    (100, "Fm", "페르뮴", 257, "악티노이드", 7, None),
    (101, "Md", "멘델레븀", 258, "악티노이드", 7, None),
    (102, "No", "노벨륨", 259, "악티노이드", 7, None),
    (103, "Lr", "로렌슘", 262, "악티노이드", 7, None),
    (104, "Rf", "러더포듐", 267, "전이금속", 7, 4),
    (105, "Db", "더브늄", 270, "전이금속", 7, 5),
    (106, "Sg", "시보귬", 271, "전이금속", 7, 6),
    (107, "Bh", "보륨", 270, "전이금속", 7, 7),
    (108, "Hs", "하슘", 277, "전이금속", 7, 8),
    (109, "Mt", "마이트너륨", 278, "전이금속", 7, 9),
    (110, "Ds", "다름슈타튬", 281, "전이금속", 7, 10),
    (111, "Rg", "륨게늄", 282, "전이금속", 7, 11),
    (112, "Cn", "코페르니슘", 285, "전이금속", 7, 12),
    (113, "Nh", "니호늄", 286, "기타금속", 7, 13),
    (114, "Fl", "플레로븀", 289, "기타금속", 7, 14),
    (115, "Mc", "모스코븀", 290, "기타금속", 7, 15),
    (116, "Lv", "리버모륨", 293, "기타금속", 7, 16),
    (117, "Ts", "테네신", 294, "할로젠", 7, 17),
    (118, "Og", "오가네손", 294, "비활성기체", 7, 18),
]

df = pd.DataFrame(elements, columns=["atomic_num", "symbol", "name", "atomic_mass", "category", "period", "group"])

# 카테고리별 색상
category_colors = {
    "알칼리금속": "#FF6666",
    "알칼리토금속": "#FFDEAD",
    "준금속": "#CCCC99",
    "비금속": "#66CCFF",
    "할로젠": "#66FF99",
    "비활성기체": "#FFB266",
    "기타금속": "#FFD700",
    "전이금속": "#FFB6C1",
    "란타노이드": "#DA70D6",
    "악티노이드": "#BA55D3",
}

st.title("🌈 전 주기율표 인터랙티브 🌈")
st.markdown("원소를 클릭하면 상세 정보를 보여줘요!")

# 7주기 18족 배열 (None일 경우 빈칸)
periods = 7
groups = 18
table = [["" for _ in range(groups)] for _ in range(periods)]

for _, row in df.iterrows():
    p = int(row["period"]) - 1
    g = row["group"]
    if not pd.isna(g):
        g = int(g) - 1
        table[p][g] = row["symbol"]

# 선택 상태 초기화
if "selected" not in st.session_state:
    st.session_state.selected = None

# 주기율표 출력 (컬럼 이용)
for p in range(periods):
    cols = st.columns(groups)
    for g in range(groups):
        sym = table[p][g]
        if sym:
            elem = df[df["symbol"] == sym].iloc[0]
            color = category_colors.get(elem["category"], "#DDD")
            style = f"""
                background-color: {color};
                border-radius: 10px;
                padding: 15px 0px;
                text-align: center;
                font-weight: 700;
                font-size: 20px;
                cursor: pointer;
                user-select:none;
            """
            if cols[g].button(sym, key=f"{p}-{g}", help=elem["name"], use_container_width=True):
                st.session_state.selected = sym
        else:
            cols[g].write("")

st.markdown("---")

# 선택된 원소 정보 보여주기
if st.session_state.selected:
    sel = st.session_state.selected
    elem = df[df["symbol"] == sel].iloc[0]
    st.markdown(f"""
    <div style="background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);
                border-radius: 25px; padding: 30px; color: #222; max-width: 600px;">
        <h1 style="font-size: 70px; margin: 0;">{elem['symbol']}</h1>
        <h2 style="margin: 0;">{elem['name']}</h2>
        <p><strong>원자번호:</strong> {elem['atomic_num']}</p>
        <p><strong>원자량:</strong> {elem['atomic_mass']}</p>
        <p><strong>분류:</strong> {elem['category']}</p>
        <p><strong>주기:</strong> {elem['period']}기</p>
        <p><strong>족:</strong> {elem['group'] if pd.notna(elem['group']) else '해당없음'}</p>
    </div>
    """, unsafe_allow_html=True)
else:
    st.info("주기율표에서 원소를 클릭하세요!")

# 버튼 호버 CSS 추가
st.markdown("""
<style>
div.stButton > button {
    transition: background-color 0.3s ease, color 0.3s ease;
    border: none;
    border-radius: 10px;
}
div.stButton > button:hover {
    background-color: #3399ff !important;
    color: white !important;
}
</style>
""", unsafe_allow_html=True)
